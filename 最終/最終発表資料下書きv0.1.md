---
marp: true
math: mathjax
header: "大規模言語モデルによるソフトウェア脆弱性の検出"
paginate: true
style: |
  section{
    font-size: 38px;
  }
  strong {
    color: #F79428;
  }
  em {
    font-style: normal;
    color: #0B3E8D;
    font-weight: bold;
  }
  h1 {
    font-size:48px;
    color: #0B3E8D;
  }
  h2 {
    font-size:48px;
    color: #0B3E8D;
    margin-bottom:-.2em;
  }
  h2 strong {
    font-size:48px;
    color: chocolate;
  }
  h3 {
    font-size:40px;
    color: #0B3E8D;
    margin-top:-.2em;
    margin-bottom:-.1em;
  }
  h3 strong {
    color: chocolate;
  }
  .columns {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 1rem;
  }
  .columns.var {
    display: grid;
    grid-template-columns: var(--ratio) 1fr;
    gap: 1rem;
  }
  .columns.spaced {
    display: grid;
    grid-template-columns: var(--ratio) 10% 1fr;
    gap: 1rem;
  }
  .gray {
    background: whitesmoke;
  }
  .theorem {
    background: whitesmoke;
    padding-top: 0.1em;
    padding-bottom: 0.1em;
    padding-left: 0.4em;
  }
  .statement {
    margin-top: -0.5em;
    padding-left: 0.7em;
  }
  .quote {
    background: whitesmoke;
    margin-left: 5%;
    margin-right: 5%;
    margin-bottom: 3%;
  }
  .quote.white {
    background: white;
  }  .katex .delimcenter,
  .katex .op-symbol {
    display: inline-block;
  }  
  .arrow {
    margin-top: auto;
    margin-bottom: auto;
    margin-left: auto;
    margin-right: auto;
    width: 0; 
    height: 0;   
  }
  .arrow.right {
    border-top: 40px solid transparent;
    border-bottom: 40px solid transparent;
    border-left: 40px solid gray;
  }
  .arrow.down {
    border-left: 40px solid transparent;
    border-right: 40px solid transparent;
    border-top: 40px solid gray;
  }
  .arrow.up {
    border-left: 40px solid transparent;
    border-right: 40px solid transparent;
    border-bottom: 40px solid gray;
  }
  .center {
    margin-right: auto;
    margin-left: auto;
    text-align: center; 
        font-size: 28px;
  }
  .middle {
    margin-top: auto;
    margin-bottom: auto;
  }
  .large {
    font-size: 28pt;
  }
  .hline {
    margin-top:20px;
    margin-bottom:20px;
    margin-left: 0%;
    margin-right: 0%;
    width: 1fr; 
    height: 0;   
    border-top: 2px solid gray;
  }
  .vline {
    margin-top:0%;
    margin-bottom:0%;
    margin-left: 20px;
    margin-right: 20px;
    width: 0; 
    height: 1fr;   
    border-left: 2px solid gray;
  }
  .shade {
    width: 1fr;
    background: white;
    opacity: 0.7;   
  }
  .white {
    width: 1fr;
    background: white;
  }
  .split{
    display: table;
  }
  .split-item {
    display: table-cell;
    padding: 0px;
  }
  .split-left {
    position: fixed;
  }
  .split-right {
    position: fixed;
    right: 0;
  }
---
<!-- 全体の流れを見直す必要あり -->

# 大規模言語モデルによるソフトウェア脆弱性の検出

#### 高知大学 理工学部情報科学科 B4
#### 横川武典

---

## 1. 研究背景
<!-- Webアプリの現状について書く -->

言語モデルを用いたコーディングが普及
$\rightarrow$セキュリティに関する指示をしない場合**脆弱なコードが生成**

Webアプリケーションは公開範囲が広い
$\rightarrow$脆弱性が実際の**セキュリティ事故**に直結

![](./AI_CodingTools.png)
<div class='center'>図1. コーディングに使われる言語モデルが含まれるツールの例</div>

--- 

<!-- LLMを使って既存手法では検出が難しい脆弱性を見つけたい期待について書く -->
言語モデルを活用すると**文脈**を考慮できる
$\rightarrow$ ルールベースでは発見の難しい脆弱性の検出が可能

<br/>

一方で、以下の問題がある
- **誤検知** 
- **検出漏れ** 

$\rightarrow$ 使い方次第で検出性能が変化

--- 

## 2. 研究目的
言語モデルで脆弱性を**自動で検知**する際、
モデルの利用方法の違いが検出に与える影響を調べる

以下の3種類の脆弱性検出の**精度**/**安定性**を評価
- 素の言語モデル
- **FineTuning**を行った言語モデル
- **RAG**を利用した言語モデル

---

## 3. 既存手法
**従来の脆弱性検出手法**は大きく2つに分けられる
<div class="split">
  <div class=" split-left">
    <h3>静的解析</h3>
    <ul>
      <li>実行せずにコードを解析</li>
      <li>ルールベース中心 </li>
      <li><strong>誤検知が多い</strong></li>
    </ul>
  </div>
  <div class="split-right">
    <h3>動的解析</h3>
    <ul>
      <li>実行時の挙動を解析</li>
      <li>実環境に近い検出</li>
      <li><strong>検出漏れが発生しやすい</strong></li>
    </ul>
  </div>
</div><br/><br/><br/><br/>

---

<!-- LLMがセキュリティ分野においてどう使われているかを書く -->
### セキュリティ分野での言語モデルの活用
言語モデルは**セキュリティ関連タスク**にも活用

- **脆弱性の説明・要約**
  - 脆弱性レポートやアラートの理解支援
- **脆弱性検出**
  - コードの文脈を考慮した指摘が可能


$\rightarrow$ **LLMの出力の信頼性**が重要
　 特に脆弱性検出では**誤検知・検出漏れが実運用に影響**

--- 

<!-- github copilotは脆弱性が修正可能と謳っている -->
<!-- https://docs.github.com/ja/copilot/tutorials/copilot-chat-cookbook/analyze-security/find-vulnerabilities -->

<!-- LLMを使ったソフトウェアの脆弱性検出手法の調査 -->
<!-- https://arxiv.org/html/2502.07049v2 -->

## 4. 関連研究
#### LLMs in Software Security: A Survey of Vulnerability Detection Techniques and Insights [Ze Sheng+2025]
<!-- 図があると良い -->

- **コードの断片**から脆弱性を検出できる言語モデルが存在
- **リポジトリ**単位では限定的な脆弱性の検出のみ可能
- メモリ関連の脆弱性は検出精度が高い
- C/C++に関する研究が多い

---

## 5. 提案手法
<!-- 全体の概要 -->
脆弱性のデータベースを取得
データベースを参照/学習に使い脆弱性を発見可能に

1. 脆弱性のデータベースを取得/作成
2. データベースを元に**RAG**の作成/**FineTuning**
3. 各モデルでソースコードから脆弱性を探す

---

### RAG(Retrieval-Augmented Generation)とは
<!-- RAGについて -->
<!-- 図を修正 -->
RAGは**事前学習していない外部知識を検索しその情報に基づいて文章を生成する手法**

<div class="split">
  <div class="split-item split-left">
    以下の3段階で機能<br/>
    1. クエリと<strong>類似する情報</strong>を<br/>
    データベースから検索<br/>
    2. <strong>得られた情報</strong>をプロンプトに追加<br/>
    3. LLMにプロンプトを入力して推論<br/>
  </div>
  <div class="split-item split-right">
    <img src="./what_is_rag_img.png">
  </div>
</div> <br/><br/><br/><br/><br/>

---

### FineTuningとは
<!-- FTについて -->
<!-- 図があるとよい？ -->
既存の学習済みモデルに，**追加の学習を行い特定のタスク用に
調整する**手法
メリットは以下の3つ
1. 一から学習しないため**コストが安い**
2. 最新の情報への対応
3. 特定の用途に**特化したモデル**を作成可

---

## 6. 実験設定
1. **脆弱性のデータベースを取得/作成**
$\rightarrow$ 脆弱性検出に必要な情報をまとめたデータベースを作成
2. **データベースを元にRAGの作成/FineTuning**
3. **ソースコードから脆弱性を探す**
$\rightarrow$ 言語モデルが生成したソースコード

---

## 7. 評価方法
脆弱性の検出結果を**指標**として数値化

- 対象 : PHPで記述されたWebアプリケーション
- 比較対象 : **Base** / **Fine-Tuned** / **RAG** の各構成
  - 各構成に同一コードを入力し，脆弱性の検出結果を取得
- 評価指標 : **Precision** / **Recall** / **F1-score** / **AUC**

---

## 8. 実験結果
### 検出性能の比較

---

### 誤検知(FP)の傾向

---

### 検出漏れ(FN)の傾向

---

### 修正案の比較

---

## 9. 結論

LLMは**ソフトウェア脆弱性検出に活用可能**
ただし**利用方法により検出性能は大きく異なる**

- Fine-Tuningは，
  **検出精度の安定化**に有効
- RAG構成は，
  **知識依存度の高い脆弱性**で効果を示した

---

## 10. 今後の課題
- より大規模・多様なコードでの検証
- 脆弱性検出結果の**根拠や判断理由の可視化**
- 実運用を想定した**誤検知への対応方法の検討**

---

## 参考文献

- [Ze Sheng+2025] LLMs in Software Security: A Survey of Vulnerability Detection Techniques and Insights\
 https://arxiv.org/html/2502.07049v2

- JVN iPedia - 脆弱性対策情報データベース\
 https://jvndb.jvn.jp/

- CVE: Common Vulnerabilities and Exposures\
 https://www.cve.org/CVERecord

---

## Appendix A. WEB言語の脆弱性の傾向

2022年に脆弱性が悪用された技術としてWordPressがトップ
全体の1/4を占めた

<div class="center">
<img src="./linux-threat-landscape-figure.jpg">
</div>

--- 

<!-- RAG -->
<!-- https://qiita.com/yagiyanagi/items/bfff61dbd077eb391812 -->

<!-- FineTuning -->
<!-- https://www.codemajin.net/fine-tuning-llm-with-unsloth/ -->

## Appendix B. データベースからFineTuning/RAGを作成する手法
- RAGを作成する場合
**自然言語**で書かれた脆弱性のデータベースを**ベクトル**に変換
この処理はPythonの"LangChain"等のライブラリを使用

- FineTuningの場合
オープンソースで公開されている言語モデルに脆弱性の
データベースで**追加学習**
この処理はPythonの"unsloth", "trl"等のライブラリを使用

---

## Appendix C. ローカルで動作する言語モデルの不安定な出力

- gpt-oss-20b\
10回応答を生成して、問題を検出できたのは1度のみ\
クロスサイトリクエストフォージェリx1

```
<|end|><|start|>assistant!!!! for.
 You`` might. be Let's your..   the0..
 a let's
 theLet's..   be1. 
the. . to!. Let's e this.. e .?
```

---

- Qwen3-14B\
10回応答を生成して、問題を検出できたのは7回\
セッションハイジャックx1
クロスサイトリクエストフォージェリx7
```
But the results section is only displayed if $results is not empty.
 ⋮
the code doesn't display the results section again because $re
$ 
↑最終的な出力に移らず終了する
```
